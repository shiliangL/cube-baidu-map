(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["cube-map-draw"]=t():e["cube-map-draw"]=t()})("undefined"!==typeof self?self:this,(function(){return function(e){function t(t){for(var i,r,s=t[0],l=t[1],c=t[2],u=0,d=[];u<s.length;u++)r=s[u],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&d.push(o[r][0]),o[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);p&&p(t);while(d.length)d.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,s=1;s<n.length;s++){var l=n[s];0!==o[l]&&(i=!1)}i&&(a.splice(t--,1),e=r(r.s=n[0]))}return e}var i={},o={3:0},a=[];function r(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var s=("undefined"!==typeof self?self:this)["webpackJsonpcube_map_draw"]=("undefined"!==typeof self?self:this)["webpackJsonpcube_map_draw"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var p=l;return a.push(["fb15",1,0,2,4]),n()}({"24f9":function(e,t,n){},"2af9":function(e,t,n){"use strict";n("4160"),n("b0c0"),n("159b");var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"cube-draw-map"},[n("baidu-map",{staticClass:"bm-view",attrs:{"map-click":!1,"scroll-wheel-zoom":!0,center:e.defaultConfig.mapCenter,ak:e.defaultConfig.akey},on:{ready:e.ready}},[n("bm-control",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}},[e.map?n("map-drawing-tools",e._b({attrs:{drawType:e.drawTypeList},on:{draw:e.draw}},"map-drawing-tools",e.$attrs,!1)):e._e()],1),e.map?n("bm-control",[n("bm-control",{key:"0b31ab34-33c1-4d49-bd04-eced3fd4f999"},[e._l(e.markers,(function(e,t){return[n("bm-control",{key:"polygons_bm_marker_Item"+t},[n("bm-marker",{key:t+"line_list_bm_marker_one",attrs:{position:e.point}})],1)]}))],2),n("bm-control",{key:"f1a7c4d6-de54-42f6-b784-ee802466d55d"},[e._l(e.polylines,(function(t,i){return[n("bm-control",{key:"polygons_bm_polyline_Item"+i},[n("bm-polyline",{key:i+"polygons_bm_polyline_one",attrs:{path:t.point,editing:t.editing,"stroke-color":t.strokeColor||e.defaultConfig.styleOptions.strokeColor,"fill-color":t.fillColor||e.defaultConfig.styleOptions.fillColor,"fill-opacity":t.fillOpacity||e.defaultConfig.styleOptions.fillOpacity,"stroke-opacity":t.strokeOpacity||e.defaultConfig.styleOptions.strokeOpacity,"stroke-style":t.strokeStyle||e.defaultConfig.styleOptions.strokeStyle,"stroke-weight":t.strokeWeight||e.defaultConfig.styleOptions.strokeWeight},on:{click:function(n){return e.click(n,t)},rightclick:function(n){return e.rightclick(n,t,i)},lineupdate:function(n){return e.polygonUpdate(n,t,i,"polylines")}}}),t.centerPoint?n("bm-control",[e._t("overlay-center",null,{row:t})],2):e._e()],1)]}))],2),n("bm-control",{key:"7ac63c28-2833-41e0-bfd8-6dc33abcc7c5"},[e._l(e.polygons,(function(t,i){return[n("bm-control",{key:"polygons_bm_polygon_Item"+i},[n("bm-polygon",{key:i+"polygons_bm_polygon_one",attrs:{path:t.point,editing:t.editing,"stroke-color":t.strokeColor||e.defaultConfig.styleOptions.strokeColor,"fill-color":t.fillColor||e.defaultConfig.styleOptions.fillColor,"fill-opacity":t.fillOpacity||e.defaultConfig.styleOptions.fillOpacity,"stroke-opacity":t.strokeOpacity||e.defaultConfig.styleOptions.strokeOpacity,"stroke-style":t.strokeStyle||e.defaultConfig.styleOptions.strokeStyle,"stroke-weight":t.strokeWeight||e.defaultConfig.styleOptions.strokeWeight},on:{click:function(n){return e.click(n,t)},rightclick:function(n){return e.rightclick(n,t,i)},lineupdate:function(n){return e.polygonUpdate(n,t,i,"polygons")}}}),t.centerPoint?n("bm-control",[e._t("overlay-center",null,{row:t})],2):e._e()],1)]}))],2),n("bm-boundary",{ref:"boundary",attrs:{name:e.defaultConfig.mapCenter,strokeWeight:2,strokeColor:"#000",fillColor:""}})],1):e._e(),n("transition",{attrs:{name:"el-zoom-in-top"}},[e.visible?n("ul",{directives:[{name:"clickOutside",rawName:"v-clickOutside",value:e.clickOutside,expression:"clickOutside"}],staticClass:"contextmenu",style:{left:e.contextmenu.left+"px",top:e.contextmenu.top+"px"}},[n("li",{on:{click:function(t){return t.stopPropagation(),e.handlerContextmenu(1)}}},[e._v(" 开启编辑 ")]),n("li",{on:{click:function(t){return t.stopPropagation(),e.handlerContextmenu(2)}}},[e._v(" 完成编辑 ")]),n("li",{on:{click:function(t){return t.stopPropagation(),e.handlerContextmenu(0)}}},[e._v(" 删除 ")])]):e._e()])],1)],1)},o=[],a=(n("caad"),n("d81d"),n("a434"),n("dca8"),n("b85c")),r=n("fec8"),s=(n("99af"),n("c975"),n("a15b"),n("b680"),n("d3b7"),n("ac1f"),n("25f0"),n("5319"),n("1276"),n("18a5"),n("53ca")),l=window.BMapLib=l||{},c="marker",p="polyline",u="circle",d="rectangle",g="polygon";function h(){var e=e||{guid:"$BAIDU$"};(function(){window[e.guid]={},e.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},e.lang=e.lang||{},e.lang.guid=function(){return"TANGRAM__"+(window[e.guid]._counter++).toString(36)},window[e.guid]._counter=window[e.guid]._counter||1,window[e.guid]._instances=window[e.guid]._instances||{},e.lang.Class=function(t){this.guid=t||e.lang.guid(),window[e.guid]._instances[this.guid]=this},window[e.guid]._instances=window[e.guid]._instances||{},e.lang.isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},e.lang.isFunction=function(e){return"[object Function]"===Object.prototype.toString.call(e)},e.lang.Class.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"},e.lang.Class.prototype.dispose=function(){for(var t in delete window[e.guid]._instances[this.guid],this)e.lang.isFunction(this[t])||delete this[t];this.disposed=!0},e.lang.Event=function(e,t){this.type=e,this.returnValue=!0,this.target=t||null,this.currentTarget=null},e.lang.Class.prototype.addEventListener=function(t,n,i){if(e.lang.isFunction(n)){!this.__listeners&&(this.__listeners={});var o,a=this.__listeners;if("string"===typeof i&&i){if(/[^\w\-]/.test(i))throw"nonstandard key:"+i;n.hashCode=i,o=i}0!==t.indexOf("on")&&(t="on"+t),"object"!==Object(s["a"])(a[t])&&(a[t]={}),o=o||e.lang.guid(),n.hashCode=o,a[t][o]=n}},e.lang.Class.prototype.removeEventListener=function(t,n){if(e.lang.isFunction(n))n=n.hashCode;else if(!e.lang.isString(n))return;!this.__listeners&&(this.__listeners={}),0!==t.indexOf("on")&&(t="on"+t);var i=this.__listeners;i[t]&&i[t][n]&&delete i[t][n]},e.lang.Class.prototype.dispatchEvent=function(t,n){for(var i in e.lang.isString(t)&&(t=new e.lang.Event(t)),!this.__listeners&&(this.__listeners={}),n=n||{},n)t[i]=n[i];var o=this.__listeners,a=t.type;if(0!==a.indexOf("on")&&(a="on"+a),e.lang.isFunction(this[a])&&this[a].apply(this,arguments),"object"===Object(s["a"])(o[a]))for(i in o[a])o[a][i].apply(this,arguments);return t.returnValue},e.lang.inherits=function(e,t,n){var i,o,a=e.prototype,r=new Function;for(i in r.prototype=t.prototype,o=e.prototype=new r,a)o[i]=a[i];e.prototype.constructor=e,e.superClass=t.prototype,"string"===typeof n&&(o._className=n)},e.dom=e.dom||{},e._g=e.dom._g=function(t){return e.lang.isString(t)?document.getElementById(t):t},e.g=e.dom.g=function(e){return"string"===typeof e||e instanceof String?document.getElementById(e):e&&e.nodeName&&(1===e.nodeType||9===e.nodeType)?e:null},e.insertHTML=e.dom.insertHTML=function(t,n,i){var o,a;return t=e.dom.g(t),t.insertAdjacentHTML?t.insertAdjacentHTML(n,i):(o=t.ownerDocument.createRange(),n=n.toUpperCase(),"AFTERBEGIN"===n||"BEFOREEND"===n?(o.selectNodeContents(t),o.collapse("AFTERBEGIN"===n)):(a="BEFOREBEGIN"===n,o[a?"setStartBefore":"setEndAfter"](t),o.collapse(a)),o.insertNode(o.createContextualFragment(i))),t},e.ac=e.dom.addClass=function(t,n){t=e.dom.g(t);for(var i=n.split(/\s+/),o=t.className,a=" "+o+" ",r=0,s=i.length;r<s;r++)a.indexOf(" "+i[r]+" ")<0&&(o+=(o?" ":"")+i[r]);return t.className=o,t},e.event=e.event||{},e.event._listeners=e.event._listeners||[],e.on=e.event.on=function(t,n,i){n=n.replace(/^on/i,""),t=e._g(t);var o,a=function(e){i.call(t,e)},r=e.event._listeners,s=e.event._eventFilter,l=n;return n=n.toLowerCase(),s&&s[n]&&(o=s[n](t,n,a),l=o.type,a=o.listener),t.addEventListener?t.addEventListener(l,a,!1):t.attachEvent&&t.attachEvent("on"+l,a),r[r.length]=[t,n,i,a,l],t},e.un=e.event.un=function(t,n,i){t=e._g(t),n=n.replace(/^on/i,"").toLowerCase();var o,a,r,s=e.event._listeners,l=s.length,c=!i;while(l--)o=s[l],o[1]!==n||o[0]!==t||!c&&o[2]!==i||(a=o[4],r=o[3],t.removeEventListener?t.removeEventListener(a,r,!1):t.detachEvent&&t.detachEvent("on"+a,r),s.splice(l,1));return t},e.getEvent=e.event.getEvent=function(e){return window.event||e},e.getTarget=e.event.getTarget=function(t){t=e.getEvent(t);return t.target||t.srcElement},e.preventDefault=e.event.preventDefault=function(t){t=e.getEvent(t);t.preventDefault?t.preventDefault():t.returnValue=!1},e.stopBubble=e.event.stopBubble=function(t){t=e.getEvent(t),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}})();var t=l.DrawingManager=function(e,t){e&&(o.push(this),t=t||{},this._initialize(e,t))};function n(){this._enableEdgeMove=!1}function i(e,t){this.drawingManager=e,t=this.drawingToolOptions=t||{},this.defaultAnchor=BMAP_ANCHOR_TOP_LEFT,this.defaultOffset=new BMap.Size(10,10),this.defaultDrawingModes=[c,u,p,g,d],t.drawingModes?this.drawingModes=t.drawingModes:this.drawingModes=this.defaultDrawingModes,t.anchor&&this.setAnchor(t.anchor),t.offset&&this.setOffset(t.offset)}e.lang.inherits(t,e.lang.Class,"DrawingManager"),t.prototype.open=function(){if(!0===this._isOpen)return!0;a(this),this._open()},t.prototype.close=function(){if(!1===this._isOpen)return!0;this._close()},t.prototype.setDrawingMode=function(e){this._drawingType!==e&&(a(this),this._setDrawingMode(e))},t.prototype.getDrawingMode=function(){return this._drawingType},t.prototype.enableCalculate=function(){this._enableCalculate=!0,this._addGeoUtilsLibrary()},t.prototype.disableCalculate=function(){this._enableCalculate=!1},t.prototype._initialize=function(e,t){if(this._map=e,this._opts=t,this._drawingType=t.drawingMode||c,t.enableDrawingTool){var n=new i(this,t.drawingToolOptions);this._drawingTool=n,e.addControl(n)}!0===t.enableCalculate?this.enableCalculate():this.disableCalculate(),this._isOpen=!(!0!==t.isOpen),this._isOpen&&this._open(),this.markerOptions=t.markerOptions||{},this.circleOptions=t.circleOptions||{},this.polylineOptions=t.polylineOptions||{},this.polygonOptions=t.polygonOptions||{},this.rectangleOptions=t.rectangleOptions||{}},t.prototype._open=function(){this._isOpen=!0,this._mask||(this._mask=new n),this._map.addOverlay(this._mask),this._setDrawingMode(this._drawingType)},t.prototype._setDrawingMode=function(e){if(this._drawingType=e,this._isOpen)switch(this._mask.__listeners={},e){case c:this._bindMarker();break;case u:this._bindCircle();break;case p:case g:this._bindPolylineOrPolygon();break;case d:this._bindRectangle();break}this._drawingTool&&this._isOpen&&this._drawingTool.setStyleByDrawingMode(e)},t.prototype._close=function(){this._isOpen=!1,this._mask&&this._map.removeOverlay(this._mask),this._drawingTool&&this._drawingTool.setStyleByDrawingMode("hander")},t.prototype._bindMarker=function(){var e=this,t=this._map,n=this._mask,i=function(n){var i=new BMap.Marker(n.point,e.markerOptions);t.addOverlay(i),e._dispatchOverlayComplete(i)};n.addEventListener("click",i)},t.prototype._bindCircle=function(){var t=this,n=this._map,i=this._mask,o=null,a=null,r=function(r){a=r.point,o=new BMap.Circle(a,0,t.circleOptions),n.addOverlay(o),i.enableEdgeMove(),i.addEventListener("mousemove",s),e.on(document,"mouseup",l)},s=function(e){o.setRadius(t._map.getDistance(a,e.point))},l=function n(r){var l=t._calculate(o,r.point);t._dispatchOverlayComplete(o,l),a=null,i.disableEdgeMove(),i.removeEventListener("mousemove",s),e.un(document,"mouseup",n)},c=function(t){e.preventDefault(t),e.stopBubble(t),null==a&&r(t)};i.addEventListener("mousedown",c)},t.prototype._bindPolylineOrPolygon=function(){var t=this,n=this._map,i=this._mask,o=[],a=null,r=null,s=!1,l=function(e){o.push(e.point),a=o.concat(o[o.length-1]),1===o.length?(t._drawingType===p?r=new BMap.Polyline(a,t.polylineOptions):t._drawingType===g&&(r=new BMap.Polygon(a,t.polygonOptions)),n.addOverlay(r)):r.setPath(a),s||(s=!0,i.enableEdgeMove(),i.addEventListener("mousemove",c),i.addEventListener("dblclick",u))},c=function(e){r&&r.setPositionAt(a.length-1,e.point)},u=function n(l){e.stopBubble(l),s=!1,i.disableEdgeMove(),i.removeEventListener("mousemove",c),i.removeEventListener("dblclick",n),r.setPath(o);var p=t._calculate(r,o.pop());t._dispatchOverlayComplete(r,p),o.length=0,a.length=0};i.addEventListener("click",l),i.addEventListener("dblclick",(function(t){e.stopBubble(t)}))},t.prototype._bindRectangle=function(){var t=this,n=this._map,i=this._mask,o=null,a=null,r=function(r){e.stopBubble(r),e.preventDefault(r),a=r.point;var c=a;o=new BMap.Polygon(t._getRectanglePoint(a,c),t.rectangleOptions),n.addOverlay(o),i.enableEdgeMove(),i.addEventListener("mousemove",s),e.on(document,"mouseup",l)},s=function(e){o.setPath(t._getRectanglePoint(a,e.point))},l=function n(r){var l=t._calculate(o,o.getPath()[2]);t._dispatchOverlayComplete(o,l),a=null,i.disableEdgeMove(),i.removeEventListener("mousemove",s),e.un(document,"mouseup",n)};i.addEventListener("mousedown",r)},t.prototype._calculate=function(e,t){var n={data:0,label:null};if(this._enableCalculate&&l.GeoUtils){var i=e.toString();switch(i){case"[object Polyline]":n.data=l.GeoUtils.getPolylineDistance(e);break;case"[object Polygon]":n.data=l.GeoUtils.getPolygonArea(e);break;case"[object Circle]":var o=e.getRadius();n.data=Math.PI*o*o;break}!n.data||n.data<0?n.data=0:n.data=n.data.toFixed(2)}return n},t.prototype._addGeoUtilsLibrary=function(){if(!l.GeoUtils){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src","http://api.map.baidu.com/library/GeoUtils/1.2/src/GeoUtils_min.js"),document.body.appendChild(e)}},t.prototype._addLabel=function(e,t){var n=new BMap.Label(t,{position:e});return this._map.addOverlay(n),n},t.prototype._getRectanglePoint=function(e,t){return[new BMap.Point(e.lng,e.lat),new BMap.Point(t.lng,e.lat),new BMap.Point(t.lng,t.lat),new BMap.Point(e.lng,t.lat)]},t.prototype._dispatchOverlayComplete=function(e,t){var n={overlay:e,drawingMode:this._drawingType,calculate:t&&t.data?t.data:null,label:t&&t.label?t.label:null};this.dispatchEvent(this._drawingType+"complete",e),this.dispatchEvent("overlaycomplete",n)},n.prototype=new BMap.Overlay,n.prototype.dispatchEvent=e.lang.Class.prototype.dispatchEvent,n.prototype.addEventListener=e.lang.Class.prototype.addEventListener,n.prototype.removeEventListener=e.lang.Class.prototype.removeEventListener,n.prototype.initialize=function(e){var t=this;this._map=e;var n=this.container=document.createElement("div"),i=this._map.getSize();return n.style.cssText="position:absolute;background:url(about:blank);cursor:crosshair;width:"+i.width+"px;height:"+i.height+"px",this._map.addEventListener("resize",(function(e){t._adjustSize(e.size)})),this._map.getPanes().floatPane.appendChild(n),this._bind(),n},n.prototype.draw=function(){var e=this._map,t=e.pixelToPoint(new BMap.Pixel(0,0)),n=e.pointToOverlayPixel(t);this.container.style.left=n.x+"px",this.container.style.top=n.y+"px"},n.prototype.enableEdgeMove=function(){this._enableEdgeMove=!0},n.prototype.disableEdgeMove=function(){clearInterval(this._edgeMoveTimer),this._enableEdgeMove=!1},n.prototype._bind=function(){var t=this,n=(this._map,this.container),i=null,o=null,a=function(e){return{x:e.clientX,y:e.clientY}},r=function(n){var r=n.type,s=(n=e.getEvent(n),t.getDrawPoint(n)),l=function(e){n.point=s,t.dispatchEvent(n)};"mousedown"===r&&(i=a(n));var c=a(n);"click"===r?Math.abs(c.x-i.x)<5&&Math.abs(c.y-i.y)<5&&(o&&Math.abs(c.x-o.x)<5&&Math.abs(c.y-o.y)<5?o=null:(l("click"),o=a(n))):l(r)},s=["click","mousedown","mousemove","mouseup","dblclick"],l=s.length;while(l--)e.on(n,s[l],r);e.on(n,"mousemove",(function(e){t._enableEdgeMove&&t.mousemoveAction(e)}))},n.prototype.mousemoveAction=function(e){function t(e){var t=e.clientX,n=e.clientY;return e.changedTouches&&(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY),new BMap.Pixel(t,n)}var n=this._map,i=this,o=n.pointToPixel(this.getDrawPoint(e)),a=t(e),r=a.x-o.x,s=a.y-o.y;o=new BMap.Pixel(a.x-r,a.y-s),this._draggingMovePixel=o,this._panByX=this._panByY=0,o.x<=20||o.x>=n.width-20||o.y<=50||o.y>=n.height-10?(o.x<=20?this._panByX=8:o.x>=n.width-20&&(this._panByX=-8),o.y<=50?this._panByY=8:o.y>=n.height-10&&(this._panByY=-8),this._edgeMoveTimer||(this._edgeMoveTimer=setInterval((function(){n.panBy(i._panByX,i._panByY,{noAnimation:!0})}),30))):this._edgeMoveTimer&&(clearInterval(this._edgeMoveTimer),this._edgeMoveTimer=null)},n.prototype._adjustSize=function(e){this.container.style.width=e.width+"px",this.container.style.height=e.height+"px"},n.prototype.getDrawPoint=function(t){var n=this._map,i=e.getTarget(t),o=t.offsetX||t.layerX||0,a=t.offsetY||t.layerY||0;1!==i.nodeType&&(i=i.parentNode);while(i&&i!==n.getContainer())0===i.clientWidth&&0===i.clientHeight&&i.offsetParent&&"TD"===i.offsetParent.nodeName||(o+=i.offsetLeft||0,a+=i.offsetTop||0),i=i.offsetParent;var r=new BMap.Pixel(o,a),s=n.pixelToPoint(r);return s},i.prototype=new BMap.Control,i.prototype.initialize=function(e){var t=this.container=document.createElement("div");t.className="BMapLib_Drawing";var n=this.panel=document.createElement("div");return n.className="BMapLib_Drawing_panel",this.drawingToolOptions&&this.drawingToolOptions.scale&&this._setScale(this.drawingToolOptions.scale),t.appendChild(n),n.innerHTML=this._generalHtml(),this._bind(n),e.getContainer().appendChild(t),t},i.prototype._generalHtml=function(e){var t={hander:"拖动地图"};t[c]="画点",t[u]="画圆",t[p]="画折线",t[g]="画多边形",t[d]="画矩形";var n=function(e,n){return'<a class="'+e+'" drawingType="'+n+'" href="javascript:void(0)" title="'+t[n]+'" onfocus="this.blur()"></a>'},i=[];i.push(n("BMapLib_box BMapLib_hander","hander"));for(var o=0,a=this.drawingModes.length;o<a;o++){var r="BMapLib_box BMapLib_"+this.drawingModes[o];o===a-1&&(r+=" BMapLib_last"),i.push(n(r,this.drawingModes[o]))}return i.join("")},i.prototype._setScale=function(e){var t=390,n=50,i=-parseInt((t-t*e)/2,10),o=-parseInt((n-n*e)/2,10);this.container.style.cssText=["-moz-transform: scale("+e+");","-o-transform: scale("+e+");","-webkit-transform: scale("+e+");","transform: scale("+e+");","margin-left:"+i+"px;","margin-top:"+o+"px;","*margin-left:0px;","*margin-top:0px;","margin-left:0px\\0;","margin-top:0px\\0;","filter: progid:DXImageTransform.Microsoft.Matrix(","M11="+e+",","M12=0,","M21=0,","M22="+e+",","SizingMethod='auto expand');"].join("")},i.prototype._bind=function(t){var n=this;e.on(this.panel,"click",(function(t){var i=e.getTarget(t),o=i.getAttribute("drawingType");n.setStyleByDrawingMode(o),n._bindEventByDraingMode(o)}))},i.prototype.setStyleByDrawingMode=function(e){if(e)for(var t=this.panel.getElementsByTagName("a"),n=0,i=t.length;n<i;n++){var o=t[n];if(o.getAttribute("drawingType")===e){var a="BMapLib_box BMapLib_"+e+"_hover";n===i-1&&(a+=" BMapLib_last"),o.className=a}else o.className=o.className.replace(/_hover/,"")}},i.prototype._bindEventByDraingMode=function(e){var t=this.drawingManager;"hander"===e?t.close():(t.setDrawingMode(e),t.open())};var o=[];function a(e){var t=o.length;while(t--)o[t]!==e&&o[t].close()}return l}n("b64b");function f(e,t){for(var n in t)return t.hasOwnProperty(n)&&(e[n]=e[n]&&"[object Object]"===e[n].toString()?f(e[n],t[n]):e[n]=t[n]),e}var y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map-drawing-tools"},[n("a",{on:{click:function(t){return t.stopPropagation(),e.draw(0)}}},[n("full-screen",{attrs:{theme:"outline",size:"14",fill:e.iconColor}}),e._v(" 视角 ")],1),e.preview?e._e():[n("a",{staticClass:"stop",on:{click:function(t){return t.stopPropagation(),e.draw(1)}}},[n("click-tap",{attrs:{theme:"outline",size:"14",fill:"#E6A23C"}}),e._v(" 停止绘制 ")],1),e._l(e.drawType,(function(t,i){return n("a",{key:i,style:{color:t.iconColor||""},on:{click:function(n){return n.stopPropagation(),e.draw(t.type)}}},[t.iconName?n(t.iconName,{tag:"component",attrs:{theme:t.iconTheme||"outline",size:t.iconSize||14,fill:t.iconColor||e.iconColor}}):e._e(),n("span",{domProps:{textContent:e._s(t.text)}})],1)}))]],2)},m=[],v=n("5530"),_=n("db24"),b=Object(v["a"])(Object(v["a"])({},_["c"]),{},{prefix:"icon"}),w={name:"MapDrawingTools",provide:function(){return{ICON_CONFIGS:b}},props:{preview:{type:Boolean,default:function(){return!1}},drawType:{type:Array,default:function(){return[]}},iconColor:{type:String,default:function(){return"#3894ff"}}},components:{Clear:_["a"],Waves:_["i"],MapDraw:_["g"],LocalTwo:_["f"],ClickTap:_["b"],FullScreen:_["d"],MaterialTwo:_["h"],FullScreenPlay:_["e"]},mounted:function(){},methods:{draw:function(e){this.$emit("draw",e)}}},M=w,k=(n("2ec5"),n("2877")),O=Object(k["a"])(M,y,m,!1,null,"38552c8e",null),C=O.exports,B={name:"CubeDrawMap",props:{config:{type:Object,default:function(){}},drawTypeList:{type:Array,default:function(){return[{text:"标点",iconName:"LocalTwo",iconColor:"#3894ff",type:2},{text:"画面",iconName:"MapDraw",iconColor:"#3894ff",type:3},{text:"画线",iconName:"Waves",iconColor:"#3894ff",type:4},{text:"清除",iconName:"Clear",iconColor:"#F56C6C",type:10}]}},polygons:{type:Array,default:function(){return[]}},polylines:{type:Array,default:function(){return[]}},markers:{type:Array,default:function(){return[]}}},components:{BaiduMap:r["a"],BmControl:r["c"],BmMarker:r["d"],BmPolyline:r["f"],BmPolygon:r["e"],BmBoundary:r["b"],MapDrawingTools:C},directives:{clickOutside:{bind:function(e,t,n){function i(n){if(e.contains(n.target))return!1;t.expression&&t.value(n)}e.__vueClickOutside__=i,document.addEventListener("click",i)},unbind:function(e,t){document.removeEventListener("click",e.__vueClickOutside__),delete e.__vueClickOutside__}}},created:function(){f(this.defaultConfig,this.config||{})},data:function(){return{map:null,drawingManager:null,visible:!1,contextmenu:{left:0,right:0},defaultConfig:{styleOptions:{strokeColor:"blue",fillColor:"#3689F3",strokeWeight:2,strokeOpacity:1,fillOpacity:.4,strokeStyle:"dashed"},mapCenter:"深圳市",akey:"",markers:[],polylines:[],polygons:[],circles:[],rectangle:[]}}},mounted:function(){},methods:{boundaryLoaded:function(e){this.boundaryLoadedpoints=Object.freeze(e),this.map&&this.map.setViewport(e)},ready:function(e){var t=this,n=e.map,i=e.BMap;this.BMapLib=h(),this.map=n,this.BMap=i,this.$nextTick().then((function(){var e=t.defaultConfig.styleOptions;t.drawingManager=new BMapLib.DrawingManager(n,{isOpen:!1,enableDrawingTool:!1,enableCalculate:!0,drawingToolOptions:{anchor:BMAP_ANCHOR_TOP_RIGHT,offset:new i.Size(5,5)},circleOptions:e,polylineOptions:e,polygonOptions:e,rectangleOptions:e}),t.drawingManager&&t.drawingManager.addEventListener("overlaycomplete",(function(e,n){return t.drawOverlayComplete(n)})),t.$emit("ready",{map:n,BMap:i,BMapLib:t.BMapLib}),setTimeout((function(){var e=[],n=t.$refs.boundary?t.$refs.boundary.paths:[];n.forEach((function(t){t.forEach((function(t){e.push(new i.Point(t.lng,t.lat))}))})),t.boundaryPaths=Object.freeze(e),t.getBetterViewByOverlays()}),2200)}))},getOverLayCenterPoint:function(e){for(var t=0,n=0,i=0;i<e.length;i++)t+=parseFloat(e[i].lng),n+=parseFloat(e[i].lat);return t/=e.length,n/=e.length,{lng:t,lat:n}},draw:function(e){switch(e){case 10:this.markers.splice(0,this.markers.length),this.polygons.splice(0,this.polygons.length),this.polylines.splice(0,this.polylines.length),this.$emit("update:markers",[]),this.$emit("update:polylines",[]),this.$emit("update:polygons",[]),this.$emit("clear"),this.drawingManager&&this.drawingManager.close(),console.log("清除全部");break;case 0:this.drawingManager&&this.drawingManager.close(),this.getBetterViewByOverlays();break;case 1:this.drawType=null,this.drawingManager&&this.drawingManager.close();break;case 2:this.drawingManager.open(),this.drawingManager.setDrawingMode("marker");break;case 3:this.drawingManager.open(),this.drawingManager.setDrawingMode("polygon");break;case 4:this.drawingManager.open(),this.drawingManager.setDrawingMode("polyline");break;case 5:this.drawingManager.open(),this.drawingManager.setDrawingMode("circle");break;case 6:this.drawingManager.open(),this.drawingManager.setDrawingMode("rectangle");break;default:break}},drawOverlayComplete:function(e){if(e.drawingMode){this.map&&this.map.removeOverlay(e.overlay);var t=e.overlay,n=["polygon","polyline","circle","rectangle"];if(n.includes(e.drawingMode)){var i=this.getOverLayCenterPoint(e.overlay.getPath()),o={point:t.getPath(),calculate:e.calculate,editing:!0,centerPoint:i};switch(e.drawingMode){case"polygon":this.polygons&&this.polygons.push(o);break;case"polyline":this.polylines&&this.polylines.push(o);break;case"circle":this.circles&&this.circles.push(o);break;case"rectangle":this.rectangle&&this.rectangle.push(o);break;default:break}}else{var a=t.point,r=a.lat,s=a.lng;this.markers&&this.markers.push({point:{lat:r,lng:s}})}}},click:function(e,t){},getBetterViewByOverlays:function(){var e,t=[],n=this.markers,i=this.polygons,o=this.polylines,r=Object(a["a"])(n);try{for(r.s();!(e=r.n()).done;){var s=e.value;t.push(new BMap.Point(s.point.lng,s.point.lat))}}catch(h){r.e(h)}finally{r.f()}var l,c=Object(a["a"])(i);try{for(c.s();!(l=c.n()).done;){var p=l.value;p.point.forEach((function(e){t.push(new BMap.Point(e.lng,e.lat))}))}}catch(h){c.e(h)}finally{c.f()}var u,d=Object(a["a"])(o);try{for(d.s();!(u=d.n()).done;){var g=u.value;g.point.forEach((function(e){t.push(new BMap.Point(e.lng,e.lat))}))}}catch(h){d.e(h)}finally{d.f()}this.map&&this.map.setViewport(t.length?t:this.boundaryPaths)},polygonUpdate:function(e,t,n,i){t.editing&&(t.point=e.target.getPath(),t.calculate=this.BMapLib.GeoUtils?this.BMapLib.GeoUtils.getPolygonArea(e.target):0,t.centerPoint=this.getOverLayCenterPoint(e.target.getPath()))}}},E=B,P=(n("fe73"),Object(k["a"])(E,i,o,!1,null,"8814b8d2",null)),T=P.exports;T.install=function(e){e.component(T.name,T)};var x=T,L=[x],D=function(e){L.forEach((function(t){e.component(t.name,t)}))};"undefined"!==typeof window&&window.Vue&&D(window.Vue);t["a"]={version:"0.1.1",install:D,CubeMapDraw:x}},"2c7d":function(e,t,n){},"2ec5":function(e,t,n){"use strict";var i=n("2c7d"),o=n.n(i);o.a},fe73:function(e,t,n){"use strict";var i=n("24f9"),o=n.n(i);o.a}})}));